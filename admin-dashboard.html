<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Masthan Brailour Poultry Traders</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .navbar {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1000;
        }

        .nav-brand a {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.5rem;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        .admin-dashboard {
            padding-top: 1rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            padding: 1rem;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .summary-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .price-management {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .price-inputs-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-dashboard">
        <header class="admin-header">
            <h1>Admin Dashboard</h1>
            <div class="header-actions">
                <button type="button" id="logoutBtn" class="logout-btn" aria-label="Logout">Logout</button>
            </div>
        </header>

        <main class="admin-main">
            <div class="dashboard-grid">
                <section class="price-summary">
                    <h2>Live Prices</h2>
                    <div class="summary-cards">
                        <div class="summary-card">
                            <h3>With Skin Chicken</h3>
                            <div class="price-change">
                                <span class="current-price" id="withSkinCurrent"></span>
                                <span class="change-indicator" id="withSkinChange"></span>
                            </div>
                        </div>
                        <div class="summary-card">
                            <h3>Skinless Chicken</h3>
                            <div class="price-change">
                                <span class="current-price" id="skinlessCurrent"></span>
                                <span class="change-indicator" id="skinlessChange"></span>
                            </div>
                        </div>
                        <div class="summary-card">
                            <h3>100 Eggs</h3>
                            <div class="price-change">
                                <span class="current-price" id="eggsCurrent"></span>
                                <span class="change-indicator" id="eggsChange"></span>
                            </div>
                        </div>
                        <div class="summary-card">
                            <h3>Live Rate</h3>
                            <div class="price-change">
                                <span class="current-price" id="liveRateCurrent"></span>
                                <span class="change-indicator" id="liveRateChange"></span>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="price-management">
                    <h2>Manage Prices</h2>
                    <form id="priceUpdateForm" class="admin-form" onsubmit="updatePrices(event)">
                        <div class="price-inputs-grid">
                            <div class="form-group">
                                <label for="withSkinPrice">With Skin Chicken (₹/kg)</label>
                                <input type="number" id="withSkinPrice" name="withSkinPrice" required>
                            </div>
                            <div class="form-group">
                                <label for="skinlessPrice">Skinless Chicken (₹/kg)</label>
                                <input type="number" id="skinlessPrice" name="skinlessPrice" required>
                            </div>
                            <div class="form-group">
                                <label for="eggsPrice">100 Eggs Price (₹)</label>
                                <input type="number" id="eggsPrice" name="eggsPrice" required>
                            </div>
                            <div class="form-group">
                                <label for="liveRate">Live Rate (₹/kg)</label>
                                <input type="number" id="liveRate" name="liveRate" required>
                            </div>
                        </div>
                        <button type="submit" class="submit-btn">Update Prices</button>
                    </form>
                </section>
            </div>
        </main>
    </div>

    <script>
        // Check if admin is logged in
        if (!localStorage.getItem('adminLoggedIn')) {
            window.location.href = 'admin-login.html';
        }

        // Price variables
        let currentPrices = {
            withSkinPrice: 180,
            skinlessPrice: 220,
            eggsPrice: 579,
            liveRate: 100
        };

        // Function to format price with currency symbol
        function formatPrice(price, unit = '') {
            return `₹${price}${unit}`;
        }

        // Load current prices
        function loadCurrentPrices() {
            const savedPrices = JSON.parse(localStorage.getItem('prices')) || currentPrices;
            currentPrices = savedPrices;
            console.log('Loading current prices:', currentPrices);

            document.getElementById('withSkinPrice').value = currentPrices.withSkinPrice;
            document.getElementById('skinlessPrice').value = currentPrices.skinlessPrice;
            document.getElementById('eggsPrice').value = currentPrices.eggsPrice;
            document.getElementById('liveRate').value = currentPrices.liveRate;
        }

        // Update prices
        function updatePrices(event) {
            event.preventDefault();
            
            const oldPrices = { ...currentPrices };
            
            currentPrices = {
                withSkinPrice: document.getElementById('withSkinPrice').value,
                skinlessPrice: document.getElementById('skinlessPrice').value,
                eggsPrice: document.getElementById('eggsPrice').value,
                liveRate: document.getElementById('liveRate').value,
                lastUpdated: new Date().toISOString()
            };

            console.log('Updating prices:', currentPrices);

            // Save prices
            localStorage.setItem('prices', JSON.stringify(currentPrices));
            console.log('Prices saved to localStorage');

            // Update summary
            updatePriceSummary(oldPrices, currentPrices);

            // Trigger storage event for other tabs
            window.dispatchEvent(new StorageEvent('storage', {
                key: 'prices',
                newValue: JSON.stringify(currentPrices)
            }));
            console.log('Storage event dispatched');

            alert('Prices updated successfully!');
        }

        // Update price summary
        function updatePriceSummary(oldPrices, newPrices) {
            const items = ['withSkin', 'skinless', 'eggs', 'liveRate'];
            
            items.forEach(item => {
                const currentElement = document.getElementById(`${item}Current`);
                const changeElement = document.getElementById(`${item}Change`);
                
                const oldPrice = parseFloat(oldPrices[`${item}Price`]);
                const newPrice = parseFloat(newPrices[`${item}Price`]);
                const change = newPrice - oldPrice;
                
                currentElement.textContent = formatPrice(newPrice, item === 'eggs' ? '' : '/kg');
                
                if (change !== 0) {
                    const changeText = change > 0 ? `↑ ${formatPrice(change)}` : `↓ ${formatPrice(Math.abs(change))}`;
                    changeElement.textContent = changeText;
                    changeElement.className = `change-indicator ${change > 0 ? 'increase' : 'decrease'}`;
                } else {
                    changeElement.textContent = 'No change';
                    changeElement.className = 'change-indicator';
                }
            });
        }

        // Logout function
        function handleLogout() {
            console.log('Logging out...');
            localStorage.removeItem('adminLoggedIn');
            window.location.href = 'admin-login.html';
        }

        // Initialize
        loadCurrentPrices();
        updatePriceSummary(currentPrices, currentPrices);

        // Add event listener for logout button
        document.getElementById('logoutBtn').addEventListener('click', handleLogout);
    </script>
</body>
</html> 